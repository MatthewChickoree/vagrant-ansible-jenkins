<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Vagrant Ansible Jenkins</title>

    <link type="text/css" rel="stylesheet" href="assets/css/reset.css">
    <link type="text/css" rel="stylesheet" href="http://yandex.st/highlightjs/6.1/styles/sunburst.min.css">
    <link type="text/css" rel="stylesheet" href="assets/css/docs.css">
    <link type="text/css" rel="stylesheet" href="assets/css/print.css" media="print">
    

    <script type="text/javascript" src="assets/js/jquery-1.10.1.min.js"></script>
    <script type="text/javascript" src="http://yandex.st/highlightjs/6.1/highlight.min.js"></script>
    <script type="text/javascript" src="assets/js/lunr.min.js"></script>

    

    <script type="text/javascript">var BASE_URL = "";</script>
    <script type="text/javascript" src="assets/js/viewer.js"></script>

    
</head>
<body>
    <div id="page">
        <a name="top" />
        <header id="header">
            <h1><a href="">Vagrant Ansible Jenkins</a></h1>
        </header>
        

<div id="sidebar">
    <form action="search.html"><input id="search" type="text" placeholder="Search" name="q" /></form>
    <nav id="toc">
        
    <ol>
    
        <li>
            <a href="home.html#home">Home</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="01-intro.html#introduction">Introduction</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="02-requirements-and-features.html#requirements">Requirements</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="02-requirements-and-features.html#features">Features</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="03-whats-already-inside.html#whats-already-inside">Whats Already inside</a>
            
                
    <ol>
    
        <li>
            <a href="031-checkurl-groovy-script.html#checkurl-groovy-script">CheckUrl Groovy Script</a>
            
        </li>
    
        <li>
            <a href="032-saucelabs-python-script.html#saucelabs-python-script">SauceLabs Python Script</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="04-how-to-setup.html#how-to-setup">How to Setup</a>
            
                
    <ol>
    
        <li>
            <a href="041-verify-list-of-jenkins-plugins-and-jobs-to-be-installed.html#install-plugins">Install Plugins</a>
            
        </li>
    
        <li>
            <a href="041-verify-list-of-jenkins-plugins-and-jobs-to-be-installed.html#create-jobs">Create Jobs</a>
            
        </li>
    
        <li>
            <a href="041-verify-list-of-jenkins-plugins-and-jobs-to-be-installed.html#share-files-with-the-imagebox">Share Files with the Image/Box</a>
            
        </li>
    
        <li>
            <a href="042-update-override-variables.html#update-override-variables">Update Override Variables</a>
            
        </li>
    
        <li>
            <a href="043-build-images-with-packer.html#build-images-with-packer">Build Images with Packer</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="05-create-jenkins-environment-with-vagrant.html#create-jenkins-environment-with-vagrant">Create Jenkins Environment with Vagrant</a>
            
                
    <ol>
    
        <li>
            <a href="051-provision-with-virtualbox.html#local-provisioning-with-virtualbox">Local provisioning with VirtualBox</a>
            
        </li>
    
        <li>
            <a href="052-provision-jenkins-with-aws.html#provision-with-aws-amazon-web-service">Provision with AWS (Amazon Web Service)</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="06-sample-build-pipelines.html#sample-build-pipelines">Sample Build Pipelines</a>
            
                
    <ol>
    
        <li>
            <a href="061-meanjs-pipeline.html#meanjs-pipeline">Meanjs Pipeline</a>
            
        </li>
    
        <li>
            <a href="062-java-pipeline.html#java-pipeline">Java Pipeline</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="07-documentation.html#documentation">Documentation</a>
            
                
    <ol>
    
        <li>
            <a href="07-documentation.html#about">About</a>
            
        </li>
    
        <li>
            <a href="07-documentation.html#editing-the-docs">Editing the Docs</a>
            
        </li>
    
        <li>
            <a href="07-documentation.html#generate-documentation-website">Generate Documentation Website</a>
            
        </li>
    
        <li>
            <a href="07-documentation.html#deploy-docs-to-gh-pages">Deploy Docs to GH-Pages</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="08-development.html#development">Development</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
        <li>
            <a href="known-issues.html#known-issues">Known Issues</a>
            
                
    <ol>
    
        <li>
            <a href="known-issues.html#issue-shared-workspace-jenkins-plugin-woes">Issue: shared-workspace Jenkins Plugin woes</a>
            
        </li>
    
        <li>
            <a href="known-issues.html#issue-invalid-machine-state-when-provisioning">Issue: Invalid machine state when provisioning</a>
            
        </li>
    
        <li>
            <a href="known-issues.html#issue-ansiblehost-turned-into-executable-file">Issue: ansible.host turned into executable file</a>
            
        </li>
    
        <li>
            <a href="known-issues.html#issue-ansible-provisioning-fails-when-using-jenkins-cli">Issue: Ansible Provisioning fails when using Jenkins CLI</a>
            
        </li>
    
        <li>
            <a href="known-issues.html#issue-ansible-provisioning-with-aws-fails-with-ssh-exception">Issue: Ansible Provisioning with AWS fails with SSH Exception</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="license.html#license">License</a>
            
                
    <ol>
    
</ol>

            
        </li>
    
</ol>

    </nav>
    
    <nav id="links">
        <ul>
            
        </ul>
    </nav>
    
</div>

        <div id="content">
            <h2 id="checkurl-groovy-script">CheckUrl Groovy Script</h2>
<h3 id="what-is-checkurl-">What is CheckUrl?</h3>
<p>CheckUrl is a script created to ping a website to check if it is giving a <code>200</code> response in a favorable response time.</p>
<h3 id="use-case">Use Case</h3>
<p>The perfect use case for this script is to check until a site comes online after a deploy. If it doesn&#39;t get a 200 response after a specified interval, then the deploy can be considered a failure. Works great for deploying a test or production site.</p>
<h3 id="where-is-it-">Where is it?</h3>
<p>The script is transferred to the <strong><em>/var/lib/jenkins/shared_ansible</em></strong> location on each machine provisioned. This ensures there is a consistent location on Jenkins Master and all slaves to enable seamless builds across the environment. The script does not run indefinitely; it runs for a specified amount of tries and will exit with a failure or success depending on the <code>Final Response</code>.</p>
<h3 id="how-to-use">How to Use</h3>
<p><strong><em>groovy</em></strong> and <strong><em>curl</em></strong> must be installed to run the script. Luckily these are already installed when provisioning with Ansible.</p>
<p>To get help with figuring out the arguments to pass when running the script, you can use the <strong><em>-h</em></strong> argument to see instructions.</p>
<pre><code class="lang-bash">$ groovy checkurl.groovy -h

usage: checkurl.groovy -[hmst] [url]
 -h,--help                 Show usage information
 -m,--max-time &lt;maxTime&gt;   max time in seconds before killing a curl
                           command, Default: 20
 -s,--sleep &lt;sleep&gt;        time in seconds before next retry, Default: 4
 -t,--tries &lt;tries&gt;        number of tries before exit, Default: 3
</code></pre>
<h3 id="example">Example</h3>
<p>The example below pings a site every minute and attempts 12 tries before exiting.</p>
<pre><code class="lang-bash">$ groovy /var/lib/jenkins/shared_ansible/checkurl.groovy -m 30 -s 60 -t 12 http://ec2-54-221-51-114.compute-1.amazonaws.com

Checking &#39;http://ec2-54-221-51-114.compute-1.amazonaws.com&#39; with: 
  12 tries 
  30 seconds timeout per try 
  60 seconds interval before next try 

LETS ROCK!
Response is 404: not satisfactory ... executing retry (11 left)
elapsed time: 0.359 seconds 

Response is 404: not satisfactory ... executing retry (10 left)
elapsed time: 1 minutes, 0.480 seconds 

Response is 404: not satisfactory ... executing retry (9 left)
elapsed time: 2 minutes, 0.512 seconds 


(0) Final Response is 200: site is ready!
elapsed time: 3 minutes, 4.586 seconds
</code></pre>
<p>The <strong>(0)</strong> in this line <strong>(0) Final Response is 200: site is ready!</strong> is the exit code.</p>
<ul>
<li>An exit code of <strong>0</strong> means <strong><span style="color: #65b042;">Success</span></strong></li>
<li>An exit code of <strong>1</strong> means <strong><span style="color: #B80000;">Failure</span></strong></li>
</ul>




        </div>
        <footer id="footer">
            Powered by <a href="http://github.com/maximebf/beautiful-docs">beautiful-docs</a> -
            <a href="#top">Back to top</a> - <a href="all.html">Everything on a single page</a>
            - <a href="?print=1">Print current page</a> - <a href="all.html?print=1">Print all pages</a>
            
                <a href="https://github.com/https://github.com/medullan/vagrant-ansible-jenkins.git" id="fork-me-on-github">Fork me on Github</a>
            
        </footer>
    </div>
</body>
</html>
